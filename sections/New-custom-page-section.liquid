<style>
  .section-{{ section.id }}-custom {
    position: relative;
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
    padding-left: {{ section.settings.padding_left }}px;
    padding-right: {{ section.settings.padding_right }}px;
    max-width: {{ section.settings.max_content_width }}px;
    margin: 0 auto;
     margin-bottom: 30px; 
    text-align: {{ section.settings.content_alignment }};
    background-color: {{ section.settings.background_color }};

    {% if section.settings.background_image != blank %}
      --bg-opacity: {{ section.settings.bg_opacity | divided_by: 100.0 }};
      background: linear-gradient(
        rgba(255, 255, 255, var(--bg-opacity)),
        rgba(255, 255, 255, var(--bg-opacity))
      ),
      url('{{ section.settings.background_image | image_url }}');
      background-size: {{ section.settings.bg_size }};
      background-position: {{ section.settings.bg_position }};
      background-repeat: {{ section.settings.bg_repeat }};
      {% if section.settings.bg_parallax %}
        background-attachment: fixed;
      {% endif %}
    {% endif %}
  }

  .section-{{ section.id }}-custom .foreground-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    margin-bottom: 20px;
  }

  .section-{{ section.id }}-custom .foreground-item {
    text-align: center;
  }

  .section-{{ section.id }}-custom .foreground-item img {
    display: block;
  }
</style>

<div class="section-{{ section.id }}-custom">
  {% if section.blocks.size > 0 %}
    <div class="foreground-container">
      {% for block in section.blocks %}
        {% if block.type == 'foreground_image' %}
          <div class="foreground-item" 
               style="padding-top:{{ block.settings.image_padding_top }}px;
                      padding-bottom:{{ block.settings.image_padding_bottom }}px;
                      padding-left:{{ block.settings.image_padding_left }}px;
                      padding-right:{{ block.settings.image_padding_right }}px;">
            {% if block.settings.image != blank %}
              <img src="{{ block.settings.image | image_url }}" 
                   style="width:{{ block.settings.image_width }}px;
                          height:{{ block.settings.image_height }}px;" />
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}
    </div>
  {% endif %}

  {% if section.settings.heading != blank %}
    <h2 style="font-size: {{ section.settings.heading_size }}px; color: {{ section.settings.heading_color }}">{{ section.settings.heading }}</h2>
  {% endif %}

  {% if section.settings.text != blank %}
    <div class="rte" style="font-size: {{ section.settings.text_size }}px; color: {{ section.settings.text_color }}">{{ section.settings.text }}</div>
  {% endif %}

  {% if section.settings.page != blank and pages[section.settings.page] %}
    <h2 class="page-title">{{ pages[section.settings.page].title }}</h2>
    <div class="rte">{{ pages[section.settings.page].content }}</div>
  {% endif %}

  {% if section.settings.custom_html != blank %}
    <div class="custom-html">{{ section.settings.custom_html }}</div>
  {% endif %}
</div>

{% schema %}
{
  "name": "Advanced Page",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Custom Heading" },
    { "type": "color", "id": "heading_color", "label": "Heading Color", "default": "#000000" },
    { "type": "range", "id": "heading_size", "min": 16, "max": 60, "step": 2, "unit": "px", "label": "Heading Font Size", "default": 28 },

    { "type": "richtext", "id": "text", "label": "Text Content", "default": "<p>Your content here...</p>" },
    { "type": "color", "id": "text_color", "label": "Text Color", "default": "#333333" },
    { "type": "range", "id": "text_size", "min": 12, "max": 28, "step": 1, "unit": "px", "label": "Text Font Size", "default": 16 },

    { "type": "html", "id": "custom_html", "label": "Custom HTML" },
    { "type": "page", "id": "page", "label": "Select Page" },

    { "type": "image_picker", "id": "background_image", "label": "Background Image" },
    { "type": "color", "id": "background_color", "label": "Background Colour", "default": "#ffffff" },

    { "type": "range", "id": "bg_opacity", "label": "Background Transparency", "min": 0, "max": 100, "step": 5, "unit": "%", "default": 0 },
    { "type": "checkbox", "id": "bg_parallax", "label": "Enable Parallax Background", "default": false },

    {
      "type": "select",
      "id": "bg_position",
      "label": "Background Position",
      "options": [
        { "value": "center", "label": "Center" },
        { "value": "top", "label": "Top" },
        { "value": "bottom", "label": "Bottom" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "bg_size",
      "label": "Background Size",
      "options": [
        { "value": "cover", "label": "Cover" },
        { "value": "contain", "label": "Contain" },
        { "value": "auto", "label": "Auto" }
      ],
      "default": "cover"
    },
    {
      "type": "select",
      "id": "bg_repeat",
      "label": "Background Repeat",
      "options": [
        { "value": "no-repeat", "label": "No Repeat" },
        { "value": "repeat", "label": "Repeat" },
        { "value": "repeat-x", "label": "Repeat X" },
        { "value": "repeat-y", "label": "Repeat Y" }
      ],
      "default": "no-repeat"
    },

    { "type": "range", "id": "max_content_width", "min": 400, "max": 1600, "step": 20, "unit": "px", "label": "Max Content Width", "default": 1000 },
    { "type": "range", "id": "padding_left", "min": 0, "max": 200, "step": 4, "unit": "px", "label": "Padding Left", "default": 20 },
    { "type": "range", "id": "padding_right", "min": 0, "max": 200, "step": 4, "unit": "px", "label": "Padding Right", "default": 20 },
    { "type": "range", "id": "padding_top", "min": 0, "max": 200, "step": 4, "unit": "px", "label": "Padding Top", "default": 40 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 200, "step": 4, "unit": "px", "label": "Padding Bottom", "default": 40 }
  ],
  "blocks": [
    {
      "type": "foreground_image",
      "name": "Foreground Image",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Foreground Image" },
        { "type": "range", "id": "image_width", "label": "Image Width", "min": 50, "max": 600, "step": 10, "unit": "px", "default": 200 },
        { "type": "range", "id": "image_height", "label": "Image Height", "min": 50, "max": 600, "step": 10, "unit": "px", "default": 200 },
        { "type": "range", "id": "image_padding_top", "label": "Padding Top", "min": 0, "max": 100, "step": 2, "unit": "px", "default": 0 },
        { "type": "range", "id": "image_padding_bottom", "label": "Padding Bottom", "min": 0, "max": 100, "step": 2, "unit": "px", "default": 0 },
        { "type": "range", "id": "image_padding_left", "label": "Padding Left", "min": 0, "max": 100, "step": 2, "unit": "px", "default": 0 },
        { "type": "range", "id": "image_padding_right", "label": "Padding Right", "min": 0, "max": 100, "step": 2, "unit": "px", "default": 0 }
      ]
    }
  ],
  "presets": [
    { "name": "Advanced Page" }
  ]
}
{% endschema %}
